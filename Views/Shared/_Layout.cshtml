<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - IMS</title>
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />
    <link rel="stylesheet" href="~/IMS.styles.css" asp-append-version="true" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f8f9fa; /* Light gray background */
            height: 100vh; /* Full height */
            margin: 0;
            display: flex;
        }

        .sidebar {
            width: 200px;
            background-color: darkgreen;
            height: 100vh;
            overflow-y: auto;
            transition: width 0.3s;
        }
        /* Make sidebar take full height of page */
/* .sidebar {
    width:150px;
    min-height: 100vh;  
    height: 100%;      
    background-color: #198754; 
    position: fixed;    
    top: 0;
    left: 0;
            overflow-y: auto;
            white-space: wrap;
} */

/* Push content to the right of sidebar */
/* .content {
    margin-left: 145px; 
    padding: 1px;
    display:flex;
          
} */


            .sidebar.collapsed {
                width: auto;
            }

            .sidebar .toggle-btn {
                background-color: darkslategrey;
                color: white;
                /* padding: 10px; */
                cursor: pointer;
                text-align: center;
            }

            .sidebar a {
                color: white;
                padding: 12px 20px;
                display: list-item;
                text-decoration: none;
                text-wrap:wrap;
                white-space: nowrap;
            }

                .sidebar a:hover {
                    background-color: lightgreen;
                    color: yellow;
                    display: flow;
                }

        .submenu {
            display: none;
            background-color: chartreuse;
            padding-left: 8px;
        }

        .sidebar .menu-item:hover .submenu {
            display: flow;
        }

        .nav-link:hover {
            background-color: gray;
        }

        .main {
            flex-grow: 1;
            padding: 8px;
            transition: margin-left 0.3s;
        }

        .sidebar.collapsed a span {
            display: none;
        }

        .sidebar.collapsed .submenu {
            display: none !important;
        }
        /* Custom styles for the table */
        .custom-table thead {
            background: linear-gradient(45deg, #007bff, #6610f2);
            color: white;
            text-transform: uppercase;
            font-weight: 600;
            overscroll-behavior-x:auto;
            overscroll-behavior-y:auto;
        }

        .custom-table th, .custom-table td {
            vertical-align: middle;
            padding: 12px;
        }

        .custom-table tbody tr {
            transition: background-color 0.3s ease;
        }

            .custom-table tbody tr:hover {
                background-color: limegreen;
            }

        .custom-table .btn {
            margin: 0 5px;
        }

        .custom-table .table-actions {
            white-space: nowrap;
        }
    </style>
</head>
<body>
    @{
        bool isAdmin = Convert.ToBoolean(User.FindFirst("IsAdmin")?.Value);
        string role = isAdmin ? "Admin" : "User";
    }
    @if (!string.IsNullOrEmpty(role))
    {


        @* Header Partial *@
        @* @Html.Partial("_HeaderPartial") *@
        <div class="sidebar" id="sidebar">
            <div class="toggle-btn" onclick="toggleSidebar()"><i class="fa-solid fa-bars"></i></div>

            @* Dashboard *@
            @if (role == "Admin")
            {
                <div class="menu-item">

                    <a asp-controller="Home" asp-action="Index"><i class="fa-solid fa-house"></i> <span>    Dashboard</span></a>
                </div>


            }

            @* Admin *@
            @if (role == "Admin")
            {
                <div class="menu-item">
                    <a href="#"><i class="fa-solid fa-user-tie"></i><span>  Admin <i class="fa-solid fa-angle-down"></i></span></a>
                    <div class="submenu">
                        <a asp-controller="User" asp-action="GetAllUsers"><i class="fa-solid fa-people-group"></i> Users </a>
                    </div>
                </div>
            }





            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-user"></i>  <span>Customer <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">

                    <div class="submenu">
                        <a asp-controller="Customer" asp-action="Index"><i class="fa-solid fa-users"></i>Customers</a>
                    </div>

                    <div class="submenu">
                        <a asp-controller="Sales" asp-action="Index"><i class="fa-solid fa-address-book"></i> Sales</a>
                    </div>
                    <div class="submenu">
                        <a asp-controller="CustomerPayment" asp-action="Index"> <i class="fa-solid fa-sack-dollar"></i> Payments</a>
                    </div>


                </div>


            </div>
            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-person-walking-arrow-right"></i> <span>Vendor <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">
                    <div class="submenu">
                        <a asp-controller="Vendor" asp-action="Index"><i class="fa-solid fa-person-walking-arrow-right"></i> Vendors</a>
                    </div>

                    <div class="submenu">
                        <a asp-controller="VendorBills" asp-action="Index"><i class="fa-solid fa-file-invoice-dollar"></i> Bills</a>
                    </div>
                    <div class="submenu">
                        <a asp-controller="VendorBills" asp-action="Index"><i class="fa-solid fa-print"></i> Generate Bills </a>
                    </div>

                    <div class="menu-item">
                        <a asp-controller="VendorPayments" asp-action="Index"><i class="fa-solid fa-sack-dollar"></i>  Payments</a>
                    </div>

                </div>
            </div>
            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-user-tie"></i><span>  Employee <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">
                    <a asp-controller="Employee" asp-action="Index"><i class="fa-solid fa-people-group"></i> Employees </a>
                </div>
            </div>

            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-gift"></i><span>  Product <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">

                    <div class="submenu">
                        <a asp-controller="Product" asp-action="Index"><i class="fa-solid fa-gift"></i> Products</a>
                    </div>

                </div>
            </div>
            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-layer-group"></i><span>  Stock <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">

                    <div class="submenu">
                        <a asp-controller="Stock" asp-action="Index"><i class="fa-solid fa-layer-group"></i> Stocks</a>
                    </div>

                </div>
            </div>
            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-sack-dollar"></i><span>  Expense <i class="fa-solid fa-angle-down"></i></span></a>


                <div class="submenu">
                    <a asp-controller="Expense" asp-action="Index"><i class="fa-solid fa-sack-dollar"></i> Expenses</a>
                </div>


            </div>

            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-address-book"></i><span>  Reports <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">
                    <a asp-controller="Report" asp-action="SalesReport"><i class="fa-solid fa-address-book"></i> Sales Report </a>
                </div>

            </div>


            <div class="menu-item">
                <a href="#"><i class="fa-solid fa-gear"></i> <span>  Settings <i class="fa-solid fa-angle-down"></i></span></a>
                <div class="submenu">
                    <div class="submenu">
                        <a asp-controller="Settings" asp-action="GetAllExpenseTypes"><i class="fa-solid fa-sack-dollar"></i> Expense Types</a>
                    </div>
                </div>
                <div class="submenu">
                    <div class="submenu">
                        <a asp-controller="SettingsAdminLabels" asp-action="Index"><i class="fa-solid fa-building"></i> Company Labels </a>
                    </div>
                </div>
                <div class="submenu">
                    <div class="submenu">
                        <a asp-controller="Categories" asp-action="Index"><i class="fa-solid fa-list"></i>Admin Categories</a>
                    </div>

                </div>

                <div class="submenu">
                    <div class="submenu">
                        <a asp-controller="AdminMeasuringUnitTypes" asp-action="Index"><i class="fa-solid fa-text-height"></i>Measuring Unit Types</a>
                    </div>
                </div>
                <div class="submenu">

                    <div class="submenu">
                        <a asp-controller="MeasuringUnit" asp-action="Index"><i class="fa-solid fa-helmet-un"></i> Measuring Units</a>
                    </div>

                </div>
            </div>
            @* <div class="menu-item">

            <a asp-controller="Account" asp-action="Logout"><i class="fa-solid fa-circle-user"></i> <span>Logout</span></a>
        </div> *@

        </div>

        <div class="main" id="main">
            <div aria-live="polite" aria-atomic="true" class="position-relative">
                <div class="toast-container position-absolute top-0 end-0 p-3">
                    @if (TempData["ErrorMessage"] != null)
                    {
                        <div class="toast align-items-center text-white bg-danger border-0 show"
                             role="alert" aria-live="assertive" aria-atomic="true"
                             data-bs-delay="4000" data-bs-autohide="true">
                            <div class="d-flex">
                                <div class="toast-body">
                                    <i class="fa-solid fa-circle-exclamation"></i> @TempData["ErrorMessage"]
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                            </div>
                        </div>
                    }
                    @if (TempData["Success"] != null)
                    {
                        <div class="toast align-items-xl-stretch text-white bg-success border-0 show"
                             role="alert" aria-live="assertive" aria-atomic="true"
                             data-bs-delay="4000" data-bs-autohide="true">
                            <div class="d-flex">
                                <div class="toast-body">
                                    <i class="fa-solid fa-circle-exclamation"></i> @TempData["Success"]
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto"
                                        data-bs-dismiss="toast" aria-label="Close"></button>
                            </div>
                        </div>
                    }
                    @if (TempData["InfoMessage"] != null)
                    {
                        <div class="toast align-items-xl-stretch text-white bg-info border-0 show"
                             role="alert" aria-live="assertive" aria-atomic="true"
                             data-bs-delay="4000" data-bs-autohide="true">
                            <div class="d-flex">
                                <div class="toast-body">
                                    <i class="fa-solid fa-circle-exclamation"></i> @TempData["InfoMessage"]
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                            </div>
                        </div>
                    }
                    @if (TempData["WarningMessage"] != null)
                    {
                        <div class="toast align-items-xl-stretch text-white bg-warning border-0 show"
                             role="alert" aria-live="assertive" aria-atomic="true"
                             data-bs-delay="4000" data-bs-autohide="true">
                            <div class="d-flex">
                                <div class="toast-body">
                                    <i class="fa-solid fa-circle-exclamation"></i> @TempData["WarningMessage"]
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                            </div>
                        </div>
                    }

                </div>
            </div>
            @* <div style="width:inherit; height:fit-content; background-color: lightgray;text-align:center;  ">
            <h1 style="text-decoration:double; color:orangered">Inventary Management System</h1>
            
         
        </div> *@
            <div style="width: inherit; height: fit-content; background-color: lightblue; display: flex; align-items: center; justify-content: space-between; padding: 10px 20px;">
                <!-- Empty left side for balance -->
                <div style="flex: 1;"></div>

                <!-- Center: Project Name -->
                <h1 style="text-decoration:solid; color: gray; margin: 0; flex: 1; text-align: center;">
                    IMTraders
                </h1>

                <!-- Right: Username, Role, and Logout (Profile-like) -->
                <div style="flex: 1; text-align: right; display: flex; align-items: center; justify-content: flex-end; gap: 10px;">
                    @if (Context.User.Identity.IsAuthenticated)
                    {
                        <span style="font-weight: bold; color: navy;">
                            @Context.User.Identity.Name
                        </span>
                        <span style="color: gray; font-style: italic;">

                            (@role)


                        </span>
                        @* <a asp-controller="Account" asp-action="Logout" class="btn btn-outline-danger btn-sm">
                        Logout
                    </a> *@
                        <a asp-controller="Account" asp-action="Logout" class="btn btn-outline-danger btn-sm"><i class="fa-solid fa-circle-user"></i> <span>Logout</span></a>
                    }
                    else
                    {
                        <a asp-controller="Account" asp-action="Login" class="btn btn-outline-primary btn-sm">
                            Login
                        </a>
                    }
                </div>
            </div>
            @* <div class="content">
                @RenderBody()
            </div> *@
            @RenderBody()
           
        </div>
        <script>
            function toggleSidebar() {
                $('#sidebar').toggleClass('collapsed');
            }
                    document.addEventListener("DOMContentLoaded", function () {
                    var toastElList = [].slice.call(document.querySelectorAll('.toast'))
                    toastElList.map(function (toastEl) {
                        var toast = new bootstrap.Toast(toastEl)
                        toast.show(); // show toast on page load
                    })
                });

        </script>

        <script src="~/lib/jquery/dist/jquery.min.js"></script>
        <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
        <script src="~/js/site.js" asp-append-version="true"></script>
        @await RenderSectionAsync("Scripts", required: false)
    }
</body>
</html>

